{% extends 'base.html.twig' %}

{% block title %}Liste des dÃ©penses{% endblock %}

{% block body %}

<style>
    .example-wrapper { margin: 1em auto; max-width: 800px; width: 95%; font: 18px/1.5 sans-serif; }
    .example-wrapper code { background: #F5F5F5; padding: 2px 6px; }
</style>

<form method="get" action="{{ path('depenses_list') }}">
    <label for="date">Filtrer par date :</label>
    <input type="date" name="date" value="{{ selectedDate }}">
    <button type="submit">Filtrer</button>
</form>
<div class="nav-buttons">
    <a href="{{ path('depense_form', { 'payer': 'Thibault', 'date': '2025-01-01' }) }}">ğŸ’¸ Ajouter des dÃ©penses</a>
    <a href="{{ path('salaire_add') }}" class="button-yellow">ğŸ’° Ajouter un salaire</a>
</div>
<div class="nav-buttons">
    <a href="{{ path('stats_user', { 'utilisateur': 'Thibault' }) }}" >ğŸ“Š Stats Thibault</a>
    <a href="{{ path('stats_user', { 'utilisateur': 'Lisa' }) }}" >ğŸ“Š Stats Lisa</a>
</div>



<h2>Bilan des dÃ©penses</h2>
<table>
    <tr>
        <th>Utilisateur</th>
        <th>Total dÃ©pensÃ©</th>
    </tr>
    {% for summary in monthlySummary %}
    <tr>
        <td>{{ summary.utilisateur }}</td>
        <td>{{ summary.total|number_format(2, ',', ' ') }} â‚¬</td>
    </tr>
    {% else %}
    <tr>
        <td colspan="2">Aucune dÃ©pense enregistrÃ©e pour ce mois.</td>
    </tr>
    {% endfor %}
    <tr>
        <th>Total gÃ©nÃ©ral</th>
        <th>{{ totalGeneral|number_format(2, ',', ' ') }} â‚¬</th>
    </tr>
</table>

<h3>RÃ©partition des dÃ©penses</h3>
<table>
    <tr>
        <th>Utilisateur</th>
        <th>Repartition attendue</th>
        <th>Depense rÃ©el </th>
        <th>Ecart </th>
    </tr>
    <tr>
        <td>Thibault</td>
        <td>{{ thibaultShare|number_format(2, ',', ' ') }} â‚¬</td>
        <td>{{ thibaultPaid|number_format(2, ',', ' ') }} â‚¬</td>
        <td>{{ thibaultEcart|number_format(2, ',', ' ') }} â‚¬</td>

    </tr>
    <tr>
        <td>Lisa </td>
        <td>{{ lisaShare|number_format(2, ',', ' ') }} â‚¬</td>
        <td>{{ lisaPaid|number_format(2, ',', ' ') }} â‚¬</td>
        <td>{{ lisaEcart|number_format(2, ',', ' ') }} â‚¬</td>
    </tr>
</table>

<h3>Ã‰quilibrage des comptes</h3>
<p><strong>{{ message }}</strong></p>
<h1>Liste des dÃ©penses</h1>

<table>
    <tr>
        <th>Utilisateur</th>
        <th>Montant</th>
        <th>Detail</th>
        <th>Date</th>
        <th>Perso ?</th>
        <th>Actions</th>
    </tr>
    {% for depense in depenses %}
    <tr>
        <td>{{ depense.utilisateur }}</td>
        <td>{{ depense.montant }} â‚¬</td>
        <td>{{ depense.detail }}</td>
        <td>{{ depense.date|date('d/m/Y') }}</td>
        <td>{{ depense.isPerso ? 'âœ… Oui' : 'âŒ Non' }}</td>
        <td>
            <form method="post" action="{{ path('depense_supprimer', {id: depense.id}) }}" onsubmit="return confirm('Voulez-vous vraiment supprimer cette dÃ©pense ?');">
                <button type="submit">ğŸ—‘ï¸ Supprimer</button>
            </form>
        </td>   
    </tr>
    {% endfor %}
</table>

{% endblock %}


